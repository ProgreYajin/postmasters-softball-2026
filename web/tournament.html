<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>トーナメント表 | 2026年千葉県郵便局長ソフトボール大会</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/tournament.css">
</head>
<body>
    <header class="app-header">
        <div class="header-top">
            <div class="header-container">
                <a href="index.html" class="header-logo">
                    <img src="https://drive.google.com/thumbnail?id=1i01jLSCnme9KdDuBwL8MufLNGdeo_d0x" alt="全国郵便局長会">
                </a>
                <div class="header-info">
                    <span>2026年千葉県郵便局長ソフトボール大会 | 2026.6.6</span>
                </div>
            </div>
        </div>
        <div class="header-main">
            <div class="nav-wrapper" id="navWrapper">
                <nav class="nav-links" id="navLinks">
                    <a href="index.html" class="nav-link">ホーム</a>
                    <a href="scoreboard.html" class="nav-link">試合速報 / 試合結果</a>
                    <a href="gallery.html" class="nav-link">写真ギャラリー</a>
                    <a href="schedule.html" class="nav-link">大会スケジュール</a>
                    <a href="tournament.html" class="nav-link">トーナメント表</a>
                    <a href="teams.html" class="nav-link">チーム・選手一覧</a>
                    <a href="venue.html" class="nav-link">会場案内・アクセス</a>
                    <a href="rules.html" class="nav-link">大会ルール・規約</a>
                    <a href="history.html" class="nav-link">優勝記録・歴史</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="app-main">
        <section class="page-header">
            <div class="page-header-content">
                <h1 class="page-title">トーナメント表</h1>
                <p class="page-subtitle">Tournament Bracket</p>
            </div>
        </section>

        <section class="app-container tournament-page">
            <!-- 優勝チーム表示 -->
            <div id="championSection" style="display: none;">
                <div class="champion-banner">
                    <div class="champion-trophy">🏆</div>
                    <div class="champion-label">優勝</div>
                    <div class="champion-name" id="championName"></div>
                </div>
            </div>

            <!-- トーナメント表本体 -->
            <div class="tournament-wrapper" id="tournamentWrapper">
                <div class="tournament-area" id="tournamentArea">
                    <div class="grid-overlay" id="gridOverlay"></div>
                    
                    <!-- 段のガイド（左側に配置） -->
                    <div class="stage-guide" style="top: 10px;">
                        <div><strong>優勝</strong> Y: 0-50px</div>
                    </div>
                    <div class="stage-guide" style="top: 120px;">
                        <div><strong>決勝戦</strong> Y: 100-200px</div>
                    </div>
                    <div class="stage-guide" style="top: 280px;">
                        <div><strong>準決勝</strong> Y: 250-350px</div>
                    </div>
                    <div class="stage-guide" style="top: 480px;">
                        <div><strong>1回戦</strong> Y: 500-600px</div>
                    </div>
                    <div class="stage-guide" style="top: 680px;">
                        <div><strong>チーム名</strong> Y: 700-750px</div>
                    </div>
                </div>
            </div>

            <!-- グリッド情報パネル（下部） -->
            <div class="info-panel">
                <strong>📐 グリッド情報:</strong>
                • 太い線: 100px間隔
                • 細い線: 50px間隔
                • サイズ: 1600px × 800px
                • マウスを動かすと座標が表示されます
            </div>

            <!-- マウス座標表示 -->
            <div class="mouse-coords" id="mouseCoords">
                <div><strong>マウス座標</strong></div>
                <div>X: <span id="coordX">-</span>px</div>
                <div>Y: <span id="coordY">-</span>px</div>
                <div style="font-size: 11px; margin-top: 10px; opacity: 0.7;">クリックで座標コピー</div>
            </div>
        </section>
    </main>

    <button class="refresh-btn" id="refreshBtn" title="更新">🔄</button>

    <footer class="app-footer">
        <div class="footer-content">
            <p class="copyright">© 2026 千葉県印旛地区郵便局長会</p>
        </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/tournament.js"></script>
    
    <script>
        // グリッド生成
        const gridOverlay = document.getElementById('gridOverlay');
        const width = 1600;
        const height = 800;

        // 100pxごとの太い線
        for (let x = 0; x <= width; x += 100) {
            const line = document.createElement('div');
            line.className = 'grid-line-major vertical';
            line.style.left = x + 'px';
            gridOverlay.appendChild(line);

            // X座標ラベル
            if (x > 0) {
                const label = document.createElement('div');
                label.className = 'grid-label x';
                label.textContent = x;
                label.style.left = (x - 10) + 'px';
                gridOverlay.appendChild(label);
            }
        }

        for (let y = 0; y <= height; y += 100) {
            const line = document.createElement('div');
            line.className = 'grid-line-major horizontal';
            line.style.top = y + 'px';
            gridOverlay.appendChild(line);

            // Y座標ラベル
            if (y > 0) {
                const label = document.createElement('div');
                label.className = 'grid-label y';
                label.textContent = y;
                label.style.top = (y - 10) + 'px';
                gridOverlay.appendChild(label);
            }
        }

        // 50pxごとの細い線
        for (let x = 50; x < width; x += 100) {
            const line = document.createElement('div');
            line.className = 'grid-line-minor vertical';
            line.style.left = x + 'px';
            gridOverlay.appendChild(line);
        }

        for (let y = 50; y < height; y += 100) {
            const line = document.createElement('div');
            line.className = 'grid-line-minor horizontal';
            line.style.top = y + 'px';
            gridOverlay.appendChild(line);
        }

        // マウス座標追跡
        const tournamentArea = document.getElementById('tournamentArea');
        const coordX = document.getElementById('coordX');
        const coordY = document.getElementById('coordY');

        tournamentArea.addEventListener('mousemove', (e) => {
            const rect = tournamentArea.getBoundingClientRect();
            const x = Math.round(e.clientX - rect.left);
            const y = Math.round(e.clientY - rect.top);
            
            coordX.textContent = x;
            coordY.textContent = y;
        });

        tournamentArea.addEventListener('mouseleave', () => {
            coordX.textContent = '-';
            coordY.textContent = '-';
        });

        // クリックで座標をコピー
        tournamentArea.addEventListener('click', (e) => {
            const rect = tournamentArea.getBoundingClientRect();
            const x = Math.round(e.clientX - rect.left);
            const y = Math.round(e.clientY - rect.top);
            
            const coordText = `X: ${x}px, Y: ${y}px`;
            navigator.clipboard.writeText(coordText).then(() => {
                const mouseCoords = document.getElementById('mouseCoords');
                const original = mouseCoords.style.background;
                mouseCoords.style.background = '#4CAF50';
                setTimeout(() => {
                    mouseCoords.style.background = original;
                }, 200);
            });
        });

        // PC用: マウスホイールでの縦スクロールをページ全体に委譲
        const tournamentWrapper = document.getElementById('tournamentWrapper');
        
        tournamentWrapper.addEventListener('wheel', (e) => {
            // 横スクロールが発生している、または横方向への操作の場合は通常動作
            if (Math.abs(e.deltaX) > Math.abs(e.deltaY)) {
                return;
            }
            
            // 縦方向のホイール操作の場合
            // トーナメントエリアの高さがビューポートより小さいため、
            // 縦スクロールは常にページ全体のスクロールとして扱う
            // ブラウザのデフォルト動作を許可（preventDefault しない）
            // これにより、自然なページスクロールが発生する
        }, { passive: true });
    </script>
</body>
</html>
